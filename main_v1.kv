#:kivy 1.9.2
#:import platform kivy.utils.platform
<MainWid>:
    canvas:
        Color:
            rgb: 1,1,1
        Rectangle:
            pos: self.pos
            size: self.size
<CustomButton1@Button>:
    size: 1, 1
    # color: .6, .7, .1

<StartWid>:
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    Label:
        id: texto_inicial
        size_hint_y: .1
        rgb: 0.2, 0.2, 0.2
        text: '¡Bienvenid@ a Avanto!'
    Label:
        id: texto_inicial
        size_hint_y: .2
        rgb: 0.2, 0.2, 0.2
        text: 'Inicie los ficheros en "Seleccionar base de datos"'

    Button:
        size_hint_y: .1
        text: 'Seleccionar base de datos'
        on_press: root.select_database()
    Button:
        size_hint_y: .1
        text: 'Modificar variables globales'
        on_press: root.global_vbles()

    BoxLayout:
        size_hint_y: .1
        Label:
            text:'Para realizar cambios de forma masiva:'

    Button:
        size_hint_y: .1
        text: 'Modificación masiva de datos'
        on_press: root.mod_data()
    Button:
        size_hint_y: .1
        text: 'Importación masiva de datos'
        on_press: root.open_browser()

    BoxLayout:
        size_hint_y: .1
        Label:
            text:'Visualizaciones: '

    BoxLayout:
        size_hint_y: .1

        Button:
            text: 'Economía'
            on_press: root.data_analysis()

        Button:
            text: 'Deporte'
            on_press: root.deporte()

    BoxLayout:
        size_hint_y: .1

        Button:
            text: 'Nevera'
            on_press: root.nevera()

        Button:
            text: 'Calorías'
            on_press: root.calorias()



<SelectDBWid>:
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    Button:
        size_hint_y: .1
        text: 'Conectar a base de datos'
        on_press: root.select_db()

    Label:
        id: click_label
        text: 'Elige BBDD'

    Spinner:
        id: spinner_id
        text: 'Elige la base de datos'
        values: ["movimientos", "deporte"]
        size_hint_y: .1

        on_text: root.spinner_clicked(spinner_id.text)


<SelectDBWid_fb>:
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    Button:
        size_hint_y: .1
        text: 'Añadir datos a través de csv'
        on_press: root.select_db()

    Label:
        id: click_label
        text: 'Elige BBDD'

    Spinner:
        id: spinner_id
        text: 'Elige la base de datos'
        values: ["movimientos", "deporte"]
        size_hint_y: .1

        on_text: root.spinner_clicked(spinner_id.text)

<SelectDBWid_md>:
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    Button:
        size_hint_y: .1
        text: 'Modificación masiva de datos'
        on_press: root.select_db()

    Label:
        id: click_label
        text: 'Elige BBDD'

    Spinner:
        id: spinner_id
        text: 'Elige la base de datos'
        values: ["movimientos", "deporte"]
        size_hint_y: .1

        on_text: root.spinner_clicked(spinner_id.text)

<DataWid>:
    data: ''
    data_id: ''
    canvas:
        Color:
            rgb: 0.2,0.2,0.2
        Rectangle:
            size: self.size
            pos: self.pos
    Label:
        size_hint_x: 0.9
        size_font: self.width*0.4
        text: root.data
    Button:
        size_hint_x: 0.1
        text: 'Edit'
        on_press: root.update_data(root.data_id)

<NewDataButton>:
    CustomButton1:
        font_size: self.height*0.6
        text: '+'
        pos: 1, 6
        size: 1, 1
        on_press: root.create_new_product()

<ReturnButton>:
    font_size: self.height*0.4
    text: 'Atrás'
    on_press: self.return_button()

<DataBaseWid>:
    orientation:'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        size_hint_y: 0.1
        CustomButton1: # -----------Go back
            font_size: self.height*0.25
            text: 'Atrás'
            pos: 1, 1
            size: 10, 50
            on_press: root.return_button()
        CustomButton1: # -----------Add 10 rows
            font_size: self.height*0.25
            text: 'Añadir 10 filas'
            pos: 1, 1
            size: 10, 50
            on_press: root.add_10_more()
        CustomButton1: # ---------Add
            font_size: self.height*0.6
            text: '+'
            pos: 1, 1
            size: 10, 50
            on_press: root.create_new_product()
    ScrollView:
        size: self.size
        GridLayout:
            id: container
            padding: [10,10,10,10]
            spacing: 5
            size_hint_y: None
            cols: 1
            row_default_height: root.height*0.2
            height: self.minimum_height

<DataBaseWid_deporte>:
    orientation:'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        size_hint_y: 0.1
        CustomButton1: # -----------Go back
            font_size: self.height*0.25
            text: 'Atrás'
            pos: 1, 1
            size: 10, 50
            on_press: root.return_button()
        CustomButton1: # -----------Add 10 rows
            font_size: self.height*0.25
            text: 'Añadir 10 filas'
            pos: 1, 1
            size: 10, 50
            on_press: root.add_10_more()
        CustomButton1: # ---------Add
            font_size: self.height*0.6
            text: '+'
            pos: 1, 1
            size: 10, 50
            on_press: root.create_new_product()
    ScrollView:
        size: self.size
        GridLayout:
            id: container
            padding: [10,10,10,10]
            spacing: 5
            size_hint_y: None
            cols: 1
            row_default_height: root.height*0.2
            height: self.minimum_height

<LeftLabel@Label>:
    text_size: self.size
    halign: 'left'

<MessagePopup>:
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: message
            size_hint: 1,0.8
            text: ''
        Button:
            size_hint: 1,0.2
            text: 'Regresar'
            on_press: root.dismiss()

<InsertDataWid>:
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size

    LeftLabel: # ---------- Fecha
        text: ' Fecha Operación:'
    TextInput:
        id: ti_fechao
        multiline: False
        # hint_text: 'Fecha Operación:'
        # text: 'ids.ti_fechao'
    LeftLabel: # ---------- Concepto
        text: ' Concepto:'
    TextInput:
        id: ti_Concepto
        multiline: False
        hint_text: 'Concepto:'
    LeftLabel: # ---------- Categoría
        text: ' Categoría:'
    TextInput:
        id: ti_Categoria
        multiline: False
        hint_text: 'Categoría'
    LeftLabel: # ---------- Importe
        text: ' Importe:'
    TextInput:
        id: ti_Importe
        multiline: False
        hint_text: 'Importe'
    LeftLabel:  # ---------- Etapa
        text: ' Etapa:'
    TextInput:
        id: ti_Etapa
        multiline: False
    LeftLabel:  # ---------- Ubicación
        text: ' Ubicación:'
    TextInput:
        id: ti_Ubi
        multiline: False
    BoxLayout:
        size_hint_y: 5
    BoxLayout: # ---------- Crear Salir
        Button:
            text: 'Crear'
            on_press: root.insert_data()
        Button:
            text: 'Salir'
            on_press: root.back_to_dbw()
<InsertDataWid_deporte>:
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size

    LeftLabel: # ---------- Fecha
        text: ' Fecha Operación:'
    TextInput:
        id: ti_fechao
        multiline: False
#        hint_text: 'Fecha Operación:'
    LeftLabel: # ---------- Concepto
        text: ' Concepto:'
    TextInput:
        id: ti_Concepto
        multiline: False
        hint_text: 'Concepto:'
    LeftLabel: # ---------- Importe
        text: ' Tiempo:'
    TextInput:
        id: ti_Tiempo
        multiline: False
        hint_text: 'Tiempo'
    BoxLayout:
        size_hint_y: 5
    BoxLayout: # ---------- Crear Salir
        Button:
            text: 'Crear'
            on_press: root.insert_data()
        Button:
            text: 'Salir'
            on_press: root.back_to_dbw()

<UpdateDataWid>:
    orientation: 'vertical'
    data_id: ''
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    LeftLabel: # ---------- ID
        text: ' ID: '+root.data_id
    LeftLabel: # ---------- Fecha
        text: ' Fecha Operación:'
    TextInput:
        id: ti_fechao
        multiline: False
        hint_text: 'Fecha Operación'
    LeftLabel: # ---------- Concepto
        text: ' Concepto:'
    TextInput:
        id: ti_Concepto
        multiline: False
        hint_text: 'Concepto:'
    LeftLabel: # ---------- Categoría
        text: ' Categoría:'
    TextInput:
        id: ti_Categoria
        multiline: False
        hint_text: 'Categoría'
    LeftLabel: # ---------- Importe
        text: ' Importe:'
    TextInput:
        id: ti_Importe
        multiline: False
        hint_text: 'Importe'
    LeftLabel:  # ---------- Etapa
        text: ' Etapa:'
    TextInput:
        id: ti_Etapa
        multiline: False
    LeftLabel:  # ---------- Ubicación
        text: ' Ubicación:'
    TextInput:
        id: ti_Ubi
        multiline: False
    BoxLayout:
        size_hint_y: 4
    BoxLayout:
        Button:
            text: 'Actualizar'
            on_press: root.update_data()
        Button:
            text: 'Eliminar'
            on_press: root.delete_data()
    Button: # ---------- Actualizar, Salir
        text: 'Salir'
        on_press: root.mainwid.goto_database()

<UpdateDataWid_deporte>:
    orientation: 'vertical'
    data_id: ''
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    LeftLabel: # ---------- ID
        text: ' ID: '+root.data_id
    LeftLabel: # ---------- Fecha
        text: ' Fecha Operación:'
    TextInput:
        id: ti_fechao
        multiline: False
        hint_text: 'Fecha Operación'
    LeftLabel: # ---------- Concepto
        text: ' Concepto:'
    TextInput:
        id: ti_Concepto
        multiline: False
        hint_text: 'Concepto:'
    LeftLabel: # ---------- Tiempo
        text: ' Tiempo:'
    TextInput:
        id: ti_Tiempo
        multiline: False
        hint_text: 'Tiempo'
    BoxLayout:
        size_hint_y: 4
    BoxLayout:
        Button:
            text: 'Actualizar'
            on_press: root.update_data()
        Button:
            text: 'Eliminar'
            on_press: root.delete_data()
    Button: # ---------- Actualizar, Salir
        text: 'Salir'
        on_press: root.mainwid.goto_database()


<FileBrowser>:
    cols:2
    id:my_widget
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        size_hint_y: 0.1
        orientation: 'vertical'
        BoxLayout:
            size_hint_y: 0.1
            orientation: 'horizontal'
            CustomButton1: # ---------Return
                font_size: self.height*0.25
                text:"Salir"
                pos: 1, 1
                size: 1, 5
                #size_hint_y: 0.1
                on_press: root.return_button()
            CustomButton1: # ---------Add
                font_size: self.height*0.25
                text:"Abrir"
                pos: 1, 1
                size: 1, 5
                #size_hint_y: 0.1
                on_press: root.open_file(filechooser.path, filechooser.selection)
        FileChooserListView:
            rootpath: '/storage/emulated/0/' if platform == 'android' else '/'
            id:filechooser
            on_selection: my_widget.selectfile(filechooser.selection)


<Moddata>:
    orientation:'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        size_hint_y: 0.1
        CustomButton1: # -----------Go back
            font_size: self.height*0.3
            text: 'Atrás'
            pos: 1, 1
            size: 10, 50
            on_press: root.return_button()
        CustomButton1: #
            font_size: self.height*0.3
            text: 'Eliminar todo'
            pos: 1, 1
            size: 10, 50
            on_press: root.delete_all()
        CustomButton1: # ---------Save
            font_size: self.height*0.3
            text: 'Guardar csv'
            pos: 1, 1
            size: 10, 50
            on_press: root.white_button()
    ScrollView:
        size: self.size
        GridLayout:
            id: container
            padding: [10,10,10,10]
            spacing: 5
            size_hint_y: None
            cols: 1
            row_default_height: root.height*0.2
            height: self.minimum_height

<Vbles_globalesWid>:
    orientation: 'vertical'
    data_id: ''
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    LeftLabel:
        text: ' Objetivo cuenta:'
    TextInput:
        id: Obj_cuenta
        multiline: False
        hint_text: '€'
    LeftLabel:
        text: ' Fecha límite para conseguirlo:'
    TextInput:
        id: Obj_fecha
        multiline: False
        hint_text: '01/01/2022'
    LeftLabel: # ---------- Concepto
        text: ' Objetivo peso:'
    TextInput:
        id: Obj_peso
        multiline: False
        hint_text: ' Kg'
    LeftLabel: # ---------- Categoría
        text: ' Domiciliaciones:'
    TextInput:
        id: Domiciliaciones
        multiline: False
        hint_text: 'ABONO, SPOTIFY,...'
    LeftLabel: # ---------- Importe
        text: ' Objetivo tasa de ahorro:'
    TextInput:
        id: Obj_tasa
        multiline: False
        hint_text: '%'
    BoxLayout:
        size_hint_y: 4
    BoxLayout:
        Button:
            text: 'Salir'
            on_press: root.back_to_dbw()
        Button:
            text: 'Actualizar'
            on_press: root.update_data()


<DataAnalysisWid>:
    orientation: 'vertical'
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        size_hint: 1, 0.1
        Button:
            text: 'Salir'
            on_press: root.go_back()

        Button:
            text: 'No hace nada'
            on_press: root.empty_button()

    BoxLayout:
        size_hint_y: 0.1

    BoxLayout:
        size_hint_y: 0.1
        Button:
            text: 'KPIs'
            on_press: root.KPIs()

        Button:
            text: 'Linea Temporal'
            on_press: root.linea_temporal()

    BoxLayout:
        size_hint_y: 0.1
        Button:
            text: 'Incremento mensual'
            on_press: root.KPIs()

        Button:
            text: 'Incremento anual'
            on_press: root.linea_temporal()

    BoxLayout:
        size_hint_y: 0.1
        Button:
            text: 'Tasa de Ahorro'
            on_press: root.KPIs()

        Button:
            text: 'Tasa de ahorro tabla'
            on_press: root.linea_temporal()

    BoxLayout:
        size_hint_y: 0.1
        Button:
            text: 'Etapa'
            on_press: root.KPIs()

        Button:
            text: 'Objetivo'
            on_press: root.linea_temporal()


    BoxLayout:
        size_hint_y: 0.1
        Button:
            text: 'Resumen'
            on_press: root.KPIs()

        Button:
            text: 'Día de la semana'
            on_press: root.linea_temporal()

    BoxLayout:
        size_hint_y: 0.1
        Button:
            text: '-'
            on_press: root.KPIs()

        Button:
            text: '-'
            on_press: root.linea_temporal()

    BoxLayout:
        size_hint_y: 0.1
        Button:
            text: '-'
            on_press: root.KPIs()

        Button:
            text: '-'
            on_press: root.linea_temporal()


<KPIWid>:
    orientation: 'vertical'
    data_id: ''
    canvas:
        Color:
            rgb: .254,.556,.627
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            size_hint: 1, 0.2
            orientation: 'vertical'
            Label:
                size_hint_y: 0.3
                text: 'Cuenta: '
            Label:
                size_hint_y: 0.7
                font_size: self.height*0.2
                id: saldo
        BoxLayout:
            size_hint: 1, 0.2
            orientation: 'horizontal'
            BoxLayout:
                size_hint_x:0.33
                orientation:'vertical'
                Label:
                    size_hint_y: 0.2
                    font_size:self.height*0.4
                    text: 'Ahorro Objetivo Mensual: '
                    halign: 'left'
                Label:
                    size_hint_y: 0.8
                    font_size: self.height*0.2
                    id: ahorro_obj_mensual

            BoxLayout:
                size_hint_x:0.33
                orientation:'vertical'
                Label:
                    size_hint_y: 0.2
                    font_size:self.height*0.4
                    text: 'Tasa de Ahorro Media: '
                    halign: 'left'
                Label:
                    size_hint_y: 0.8
                    font_size: self.height*0.2
                    id: tasa_ahorro

            BoxLayout:
                size_hint_x:0.33
                orientation:'vertical'
                Label:
                    size_hint_y: 0.2
                    font_size:self.height*0.4
                    text: 'Ahorro Real Mensual: '
                    halign: 'left'
                Label:
                    size_hint_y: 0.8
                    font_size: self.height*0.2
                    id: ahorro_real_mes
        Label:
            size_hint_y: 0.5

        BoxLayout:
            size_hint: 1, 0.1
            orientation: 'horizontal'
            Button:
                text: 'Salir'
                pos: 1, 1
                size: 10, 50
                on_press: root.return_button()

            Button:
                text: 'Salir'
                pos: 1, 1
                size: 10, 50
                on_press: root.return_button()

